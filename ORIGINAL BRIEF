Project Handover: Chapter Auto-Roster Engine
 - Project Overview
Objective: Develop a Python-based discrete event simulation to manage the personnel roster of a Warhammer 40k Space Marine Chapter. The system must transition from a Historical Reconstruction to a Procedural Foundry (generating new characters to maintain a target population), handling complex recruitment, mortality, and rank assignment logic over a 500-year timeline.

Output: The system must overwrite a specific Google Sheet tab (Auto-Roster) with a complete, formatted roster at the end of the simulation.

 - Technical Stack & Credentials
Language: Python 3.10+
Libraries: pandas, gspread, gspread_dataframe, google-auth (add more as needed)
Target: Google Sheets.
Sheet ID: 1FmexJsqPIEVe4OgLWv2j1I3LUqsHhPBKEj48T8mW780
Tab Name: Auto-Roster
Auth: Service Account via credentials.json (root directory).

 - User Editable Var's at top of python file
 Number of new Neophytes that start training each year (new people to add to roster((If this value is 0, use logic described below))
	If 0 - The number of new Neophyte that can be added is the number of available Neophyte slots in the 10th company. Promote all that can be promoted to Battle Brother (Assign them to Chapter Command) and then fill slots with new Neophyte's

 - EXISTING FORMAT

Column headers are on ROW 2
They are, from A - M, 
Chapter ID Number	
Name	
Cognomen / Earned Name	
Born	
Date of Geneseed Implantation	
Date of Death	
Age (Or Age at Death)	
Wargear	
Rank History	
Deployment History	
Personality / Psy-Profile	

 - OUTPUT
	Outputted Rank History should look like the example below.
Battle Brother (668.M41 - 806.M41)  (21 Years old on date of promotion)
Neophyte (660.M41 - 668.M41)  (13 Years old on date of promotion)

	Outputted Deployment History should look like the example below.
Company Command (668.M41 - 806.M41) (138 Years)
10th Company, 7th Squad (660.M41 - 668.M41) (8 Years)


 - Core Simulation Parameters
Timeline: 540.M41 to 018.M42.
Key Event - Refounding: 636.M41.
Key Event - Ramp Up: 638.M41 
Target Population: 1200 Total (1000 Active in Squads + ~200 in Chapter Command).

4. Organization & Squad Roles (Strict Requirement)
The simulation must enforce specific job titles for specific slots within the Companies.

4.1. Company 1
Squad 1 (Chapter Command):
Slot 0: Chapter Master
Slot 1: Chaplain
Slot 2: Apothecary
Slot 3: Techmarine
Slot 4: Standard Bearer
Slot 5: Null-Warden
Slots 6-9: Veteran Battle Brother
Squads 2 & 3 (Honor Guard):
Slot 0: Commander
Slot 1: Apothecary
Slots 2-9: Veteran Battle Brother
Squads 4-10:
Slot 0: Veteran Sergeant
Slots 1-9: Veteran Battle Brother
4.2. Company 10 (The Scout Company)
Squad 1 (Instructors):
Slot 0: Captain
Slots 1-2: Lieutenant
Slot 3: Standard Bearer
Slot 4: Null-Warden
Slots 5-9: Chaplain
Squads 2-10 Neophyte:
Slots 0-9: Neophyte
4.3. Standard Companies (2 through 9)
Squad 1 (Company Command):
Slot 0: Captain
Slots 1-2: Lieutenant
Slot 3: Standard Bearer
(Company 5 Only) Slot 4: Techmarine
Remainder: Battle Brother
Squad 2 (The Specialist Retinue):
Slot 0: Chaplain
Slot 1: Null-Warden
Slots 2-3: Apothecary
Slots 4-5: Artificer Brother
Slots 6-7: Bond-Keeper
Slots 8-9: Battle Brother
Squads 3-10 (Line Squads):
Slot 0: Sergeant
Slots 1-9: Battle Brother

4.4. Special Exceptions
Company 5 (The Artificers): In Squads 3-10, Slots 6-9 must be filled by Artificer Brother.
The Runt Squads: Squad 10 in Companies 3, 4, and 5 are designated for Battle Brother (Runt).

5. Logic Flow
5.1. Mortality (Dynamic Attrition)
Calculate current population.
Peace Time (<800 active): 0.2% death chance.
Building (<1000 active): 1.0% death chance.
War (>1000 active): 2.0% death chance.
Modifiers: Neophytes (+3%), Officers (-90% Plot Armor).

 - Recruitment (The Pipeline)
Neophyte Intake: Calculate intake based on the "Ramp Up" curve (5 recruits in 638.M41, +10 per year) up to as many as will fit in the 10th company without going over.

 - Assignment & Promotion
 
	The Rank Hierarchy (The Ladder)
The simulation uses a Tier System to determine eligibility. A Marine generally climbs this ladder over centuries of service.

Tier 5: Captain
Tier 4: Lieutenant / Chaplain / Techmarine / Standard Bearer / Veteran Sergeant 
Tier 3: Veteran Battle Brother / Sergeant  / Apothecary / Null-Warden
Tier 2: Artificer Brother / Bond-Keeper
Tier 1: Battle Brother / Battle Brother (Runt)
Tier 0: Neophyte

2. Promotion Logic (Upward Mobility)
Promotions are Demand-Driven. A Marine is not promoted simply because they are "ready"; they are promoted because a specific slot in a specific Squad has opened up (usually due to death or injury).

We ONLY allow inter chapter moves (Moves that didnt come from the chapter command) if the person has been in their current job for over 40 years.
These are the rules for who can fill what job.

Captain - ONLY a Lieutenant
Lieutenant - Veteran Battle Brother OR Veteran Sergeant OR Standard Bearer
Chaplain - ONLY a Battle Brother
Techmarine - ONLY a Artificer Brother
Standard Bearer - Veteran Battle Brother OR Veteran Sergeant
Veteran Battle Brother - ONLY a Battle Brother
Veteran Sergeant - ONLY a Sergeant
Sergeant - ONLY a Battle Brother
Apothecary - ONLY a Battle Brother
Null-Warden - ONLY a Battle Brother
Artificer Brother - ONLY a Battle Brother
Bond-Keeper - ONLY a Battle Brother
Battle Brother - ONLY a Neophyte
Battle Brother (Runt) - ONLY a Neophyte


The Assignment Flow
We are to assume that last years names all remain the same. We only replace people that have been promoted in the same year, or have died, so may runs may be needed as someone near the end of the logic cycle may have been promoted and needs backfilling
When a slot becomes empty (e.g., Company 2, Squad 1, Slot 0: Captain), the system scans Chapter Command for the best candidate.
Ideal Candidate: A Marine already holding the rank of Captain (perhaps returning from injury).
Promotion Candidate: If no Captain is available, 1 tier down and promotes the person with the longest time in that rank. If 2 are found, it picks the oldest.


3. The Neophyte Pipeline (Graduation)
This is the only Automatic Promotion in the system.

Trigger: A Neophyte in the 10th Company reaches 8 Years of Service since implantation.

Action:
Rank changes to Battle Brother.
If a Battle Brother (Runt) is needed to fill the ranks this year, they get that rank
They are immediately removed from the 10th Company and placed in Chapter Command, waiting for a slot in a Battle Company (1-9).

4. Demotion Logic (Disciplinary Action)
Demotions are rare but impactful events designed to add flavor to the roster history.

Target: Only applies to Tier 3 ranks (Sergeants and Veterans). Officers (Tier 4+) are effectively immune (political protection).

Probability: Every year, every Sergeant/Veteran has a 0.5% chance of a disciplinary incident.

The Penalty:

Rank Stripped: They are immediately demoted to Battle Brother (Tier 1).
Dishonorable Discharge (from Squad): They are moved to Chapter Command

History Log: Their record will show the demotion year, e.g., Battle Brother (789.M41 - Current).


1. Definition and Identification
The Identifier: Any record in the source Auto-Roster.csv with a Chapter ID Number between 101 and 301 (inclusive).

The Concept: These are "Canon Characters." They represent the historical seed of the Chapter. They are the only entities that exist prior to the simulation's procedural generation.

2. Initialization (The Seed Phase)
Extraction: At the very start of the script execution, the engine reads the source CSV. It filters for the ID range 101-301 and stores these records in memory.

Purge: All records outside this range (e.g., IDs 001-100 or 302+) are discarded immediately.

Setup:

If an Old Guard member has a Date of Geneseed Implantation before the simulation start year (540.M41), they are immediately placed into the Reserve Pool with the status Chapter Command (Reserve).

This ensures they are available to take command of squads the moment the simulation begins.

3. Data Preservation
Immutable Fields: The simulation is forbidden from altering their:

Name

Born Date

Date of Geneseed Implantation

Existing History Strings (The text present in Rank History and Deployment History at load time must remain).

Appended History: When the simulation assigns them a new role or rank, the new string is added to their record (usually prepended) without deleting the historical data.

4. Mortality Logic (The "Plot Armor" Rules)
The Old Guard follows a unique two-step death check that overrides standard mortality.

Priority 1: Hardcoded Fate

The engine checks the Date of Death column in the CSV.

If a specific date exists (e.g., 850.M41), the Marine must die in that exact year. They are immune to random death before that year.

Priority 2: Calculated Fate

If the Date of Death is "Alive", blank, or "Current":

They are subject to random attrition, BUT they receive a massive statistical buff.

Death Chance: Flat 0.2% per year (compared to 1.0% - 2.0% for procedural marines). This effectively gives them "Plot Armor," ensuring most survive for centuries unless they are very unlucky.

5. Career Progression
Promotion: They are eligible for promotion to any rank (Sergeant, Captain, Chapter Master) based on the standard tenure rules. Because they are often older than procedural marines, they usually fill the high-command slots first.

Demotion: They are not immune to disciplinary action. If they hold a Tier 3 rank (Sergeant/Veteran), they have the same 0.5% chance per year to be demoted to Battle Brother as anyone else.

Injury: They are subject to the standard 2% injury rate, rotating them back to Chapter Command (Reserve) for 2-5 years if injured.


The python program should output the below every 5 years of the sim
Year XXX.M4X: Total Neophyt's : XXX | Total Battle-Brother + : XXX | Total Assigned to chapters 1-10: XXX | Total in Chapter Command : XXX

Every 10 years of the sim, the updated Auto-Roster document should be uploaded, and again at the end of the sim.

The python script you make should be printed out for the user to copy.